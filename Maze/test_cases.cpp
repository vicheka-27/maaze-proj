#include "test_cases.hpp"
#include "maze_solver.hpp"
#include "visualizer.hpp"
#include <iostream>
#include <vector>

void runPredefinedTest(int testNum) {
    std::vector<std::vector<int>> maze;
    std::pair<int,int> src, dest;
    
    if(testNum == 1) {
        std::cout << "\n" << BOLD << CYAN << "=== Test Case 1: Simple Path ===" << RESET << "\n";
        maze = {
            {1,0,1,1,1,1,1,1,1,1},
            {1,0,0,0,0,0,0,0,0,1},
            {1,1,1,1,1,1,1,1,0,1},
            {0,0,0,0,0,0,0,1,0,1},
            {1,1,1,1,1,1,0,1,0,1},
            {1,0,0,0,0,1,0,1,0,1},
            {1,0,1,1,0,1,0,1,0,1},
            {1,0,1,0,0,1,0,1,0,1},
            {1,1,1,1,1,1,1,1,1,1}
        };
        src = {0,0};
        dest = {8,9};
    } else if(testNum == 2) {
        std::cout << "\n" << BOLD << CYAN << "=== Test Case 2: Complex Maze ===" << RESET << "\n";
        maze = {
            
                {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
                {1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1},
                {1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1},
                {1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1},
                {1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1},
                {1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1},
                {1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1},
                {1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1},
                {1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1},
                {1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1},
                {1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1},
                {1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1},
                {1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1},
                {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
                {1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1}
            

        };
       src  = {0, 0};
dest = {14, 14};
    } else if(testNum == 3) {
        std::cout << "\n" << BOLD << CYAN << "=== Test Case 3: 20x20 Maze ===" << RESET << "\n";
        // 20x20 maze with zig-zag pattern
        maze = {
            {1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
            {1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
            {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1},
            {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1},
            {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1},
            {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1},
            {1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1},
            {1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1},
            {1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1},
            {1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
            {1,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
            {1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0},
            {1,0,1,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1},
            {1,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1},
            {1,0,1,0,1,0,1,0,1,0,1,1,1,1,1,1,1,1,0,1},
            {1,0,1,0,1,0,1,0,1,0,1,0,0,0,0,0,0,1,0,1},
            {1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,0,1,0,1},
            {1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,1,0,1,0,1},
            {1,0,1,0,1,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1},
            {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1}
        };
        src = {0,0};
        dest = {19,19};
    } else if(testNum == 4) {
        std::cout << "\n" << BOLD << CYAN << "=== Test Case 4: No Path Found (Blocked) ===" << RESET << "\n";
        // This maze has no path from start to end due to walls
        maze = {
            {1,0,1,1,1,1,1,1,1,1},
            {1,0,0,0,0,0,0,0,0,1},
            {1,1,1,1,1,1,1,1,0,1},
            {0,0,0,0,0,0,0,1,0,1},
            {1,1,1,1,1,1,0,1,0,1},
            {1,0,0,0,0,1,0,1,0,1},
            {1,0,1,1,0,1,0,1,0,1},
            {1,0,1,0,0,1,0,1,0,1},
            {1,1,1,1,1,1,1,1,0,1},  // Note: last column has 0 at dest position
            {1,0,0,0,0,0,0,0,0,0}   // Completely blocked path to dest
        };
        src = {0,0};
        dest = {9,8};  // Destination is in a completely blocked area
    } else if(testNum == 5) {
        std::cout << "\n" << BOLD << CYAN << "=== Test Case 5: Large 15x15 Maze ===" << RESET << "\n";
        maze = {
            {1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1},
            {1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1},
            {1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1},
            {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1},
            {1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1},
            {1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1},
            {1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1},
            {1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1},
            {1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1},
            {1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1},
            {1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1},
            {1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1},
            {1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1},
            {1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1},
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1}
        };
        src = {0, 0};
        dest = {14, 14};
    }
    
    Stats stats;
    std::vector<std::pair<int,int>> path = shortPath(maze, src, dest, stats);
    
    if(path.empty()){
        printMazeWithPath(maze, path, src, dest);
        std::cout << "\n" << RED << BOLD << "  No path found!" << RESET << "\n\n";
    } else {
        printMazeWithPath(maze, path, src, dest);
        printStats(stats);
    }
}

void displayMenu() {
    std::cout << "\n" << BOLD << CYAN << "=================================" << RESET << "\n";
    std::cout << BOLD << CYAN << "   MAZE SOLVER - DFS Algorithm" << RESET << "\n";
    std::cout << BOLD << CYAN << "=================================" << RESET << "\n\n";
    
    std::cout << "Options:\n";
    std::cout << "1. Run test case 1 (10x10 - Simple)\n";
    std::cout << "2. Run test case 2 (10x10 - Complex)\n";
    std::cout << "3. Run test case 3 (20x20 - Zig-Zag Maze)\n";
    std::cout << "4. Run test case 4 (10x10 - No Path Found)\n";
    std::cout << "5. Run test case 5 (15x15 - Large)\n";
    std::cout << "6. Exit\n";
    std::cout << "\nEnter choice: ";
}